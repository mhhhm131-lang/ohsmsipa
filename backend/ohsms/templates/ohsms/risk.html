{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>OHSMS โ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{% static 'assets/css/styles.css' %}">
</head>
<body>
<header class="top-header">
  <h1>ูุธุงู ุฅุฏุงุฑุฉ ุงูุณูุงูุฉ ูุงูุตุญุฉ ุงูููููุฉ โ OHSMS</h1>
  <p>ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ โ ุฅุฏุฎุงู ุงููุฎุงุทุฑ ูุงูุณุฌู ุงูุนุงู ูุงูุฎุงุต</p>
</header>

<div class="main-wrapper">
    
  <aside class="sidebar">
<h3>ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ</h3>
<a class="nav-link" href="{% url 'home' %}" data-perm="view_home">ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>
<a class="nav-link" href="{% url 'reports' %}" data-perm="view_reports">ูุธุงู ุงูุจูุงุบุงุช / ุณุฌู ุงููุชุงุจุนุฉ</a>
<a class="nav-link" href="{% url 'risk' %}" data-perm="view_risks">ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ</a>

<a class="nav-link" href="awareness.html" data-perm="view_awareness">ุงูุชูุนูุฉ ูุงูุชุซููู</a>
<a class="nav-link" href="vendors.html" data-perm="view_partners">ุงูุนููุงุก ูุงูุดุฑูุงุก</a>
<a class="nav-link" href="{% url 'forms' %}" data-perm="view_forms">ุงูููุงุฐุฌ ุงูุฑูููุฉ</a>
<a class="nav-link" href="{% url 'dashboard' %}" data-perm="view_dashboard">ููุญุฉ ุงูุชุญูู</a>
<a class="nav-link" href="{% url 'system' %}" data-perm="view_system">ุฅุฏุงุฑุฉ ุงููุธุงู</a>

</aside>
  

  <main class="content">
    <section class="card">
      <h2><span class="emoji">โ๏ธ</span>ูููุฐุฌ ุฅุฏุฎุงู ุงูุฎุทุฑ</h2>
      <p class="hint">ูู ููุง ูููู ุชุณุฌูู ุงููุฎุงุทุฑ ุงูุฌุฏูุฏุฉุ ุซู ุงุณุชุนุฑุงุถูุง ูุงุญููุง ูู ุฎูุงู ุงูุณุฌู ุงูุนุงู ุฃู ุงูุณุฌู ุงูุฎุงุต.</p>
      <form id="riskForm">
        <div class="grid-3">
          <div>
            <label>ุงููุฑุน</label>
            <input class="input" id="branch" placeholder="ูุซุงู: ูุฑุน ุงูุฑูุงุถ">
          </div>
          <div>
            <label>ุงูุฅุฏุงุฑุฉ</label>
            <input class="input" id="department" placeholder="ูุซุงู: ุฅุฏุงุฑุฉ ุงูุตูุงูุฉ">
          </div>
          <div>
            <label>ุงููุณู</label>
            <input class="input" id="section" placeholder="ูุซุงู: ูุณู 1">
          </div>
        </div>

        <div class="grid-3">
          <div>
            <label>ุงููุฆุฉ ุงูุฑุฆูุณูุฉ</label>
            <input class="input" id="mainCategory" placeholder="ูุซุงู: ุงูุณูุงูุฉ ุงูููููุงุฆูุฉ">
          </div>
          <div>
            <label>ุงููุฆุฉ ุงููุฑุนูุฉ</label>
            <input class="input" id="subCategory" placeholder="ูุซุงู: ููุงุฏ ุฎุทุฑุฉ">
          </div>
          <div>
            <label>ูุณุจุจุงุช ุงูุฎุทุฑ</label>
            <input class="input" id="hazardCause" placeholder="ูุซุงู: ุชุฎุฒูู ุบูุฑ ุณููู">
          </div>
        </div>

        <div class="grid-3">
          <div>
            <label>ุงูุดุฏุฉ (1โ5)</label>
            <input type="number" min="1" max="5" class="input" id="severity" value="1">
          </div>
          <div>
            <label>ุงูุงุญุชูุงููุฉ (1โ5)</label>
            <input type="number" min="1" max="5" class="input" id="likelihood" value="1">
          </div>
          <div>
            <label>ุงูุชูููู (ุขูููุง)</label>
            <input class="input" id="rating" readonly>
          </div>
        </div>

        <div class="grid-3">
          <div>
            <label>ุงููุชุฃุซุฑูู</label>
            <input class="input" id="affected" placeholder="ูุซุงู: ุงูููุธูููุ ุงูุฒูุงุฑ">
          </div>
          <div>
            <label>ุงูุฅุฌุฑุงุก ุงูููุงุฆู</label>
            <input class="input" id="preventiveAction">
          </div>
          <div>
            <label>ุงูุฅุฌุฑุงุก ุงูุชุตุญูุญู</label>
            <input class="input" id="correctiveAction">
          </div>
        </div>

        <div class="grid-3">
          <div>
            <label>ุงูุฅุฏุงุฑุฉ ุงููุณุคููุฉ</label>
            <input class="input" id="ownerDept">
          </div>
          <div>
            <label>ุงูุดุฎุต ุงููุณุคูู</label>
            <input class="input" id="ownerPerson">
          </div>
          <div>
            <label>ููุงุฉ ุงูุชูุงุตู</label>
            <input class="input" id="channel" placeholder="ูุงุชูุ ุจุฑูุฏ ุฅููุชุฑูููุ ูุธุงู ุฏุงุฎูู...">
          </div>
        </div>

        <label>ููุงุญุธุงุช ุฅุถุงููุฉ</label>
        <textarea class="textarea" id="notes"></textarea>

        <div style="margin-top:10px;display:flex;flex-wrap:wrap;gap:16px;align-items:center;">
          <div style="display:flex;gap:8px;align-items:center;font-size:13px;">
            <span>ููุน ุงูุณุฌู:</span>
            <label><input type="radio" name="privacy" value="public" checked> ุงูุณุฌู ุงูุนุงู</label>
            <label><input type="radio" name="privacy" value="private"> ุงูุณุฌู ุงูุฎุงุต (ุญุณุงุณ)</label>
          </div>
          <button type="submit" class="btn btn-primary">๐พ ุญูุธ ุงูุฎุทุฑ</button>
          <div id="riskMsg" class="success-msg"></div>
        </div>
      </form>
    </section>
    <section class="card" id="pendingRisksSection">
  <h2>๐ ูุฎุงุทุฑ ุจุงูุชุธุงุฑ ุงูุงุนุชูุงุฏ</h2>
  <div class="table-wrapper">
    <table class="reports" id="pendingRisksTable">
      <thead>
        <tr>
          <th>ุฑูู ุงูุฎุทุฑ</th>
          <th>ุงููุฑุน</th>
          <th>ุงูุฅุฏุงุฑุฉ</th>
          <th>ุงููุณู</th>
          <th>ุงููุฆุฉ</th>
          <th>ุงูุชูููู</th>
          <th>ุฅุฌุฑุงุก</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>


    <section class="card">
      <h2><span class="emoji">๐</span>ุงูุณุฌู ุงูุนุงู ูููุฎุงุทุฑ</h2>
      <p class="hint">ูุนุฑุถ ูุฐุง ุงูุณุฌู ุงููุฎุงุทุฑ ุงูุนุงูุฉ ุงูุชู ูููู ุงุณุชุฎุฏุงููุง ูู ุงูุชูุนูุฉ ูุงูุงุทูุงุน ุงูุนุงู.</p>
      <div class="table-wrapper">
        <table class="reports" id="publicRisksTable">
         <thead>
  <tr>
    <th>ุฑูู ุงูุฎุทุฑ</th>
    <th>ุงููุฆุฉ ุงูุฑุฆูุณูุฉ</th>
    <th>ุงููุฆุฉ ุงููุฑุนูุฉ</th>
    <th>ูุณุจุจุงุช ุงูุฎุทุฑ</th>
    <th>ุงููุชุฃุซุฑูู</th>
    <th>ุงูุงุญุชูุงููุฉ</th>
    <th>ุงูุดุฏุฉ</th>
    <th>ุงูุชูููู</th>
    <th>ุงูุฅุฌุฑุงุก ุงูุชุตุญูุญู</th>
    <th>ุงูุฅุฌุฑุงุก ุงูููุงุฆู</th>
    <th>ุงูุฅุฏุงุฑุฉ ุงููุณุคููุฉ</th>
    <th>ุงูููุธู</th>
    <th>ููุงุฉ ุงูุชูุงุตู</th>
  </tr>
</thead>
          <tbody></tbody>
        </table>
      </div>
      <p id="publicEmpty" class="empty">ูุง ุชูุฌุฏ ุณุฌูุงุช ูู ุงูุณุฌู ุงูุนุงู ุญุชู ุงูุขู.</p>
    </section>

    <section class="card">
      <h2><span class="emoji">๐</span>ุงูุณุฌู ุงูุฎุงุต ุจุงููุฎุงุทุฑ</h2>
      <p class="hint">ูุฐุง ุงูุณุฌู ูุฎุตุต ูููุฎุงุทุฑ ุงูุญุณุงุณุฉ ุงูุชู ูุง ุชุธูุฑ ุฅูุง ูููุณุชุฎุฏููู ุงููุฎููููู.</p>
      <div class="table-wrapper">
        <table class="reports" id="privateRisksTable">
          <thead>
            <tr>
              <th>ุฑูู ุงูุฎุทุฑ</th>
              <th>ุงููุฑุน</th>
              <th>ุงูุฅุฏุงุฑุฉ</th>
              <th>ุงููุณู</th>
              <th>ุงููุฆุฉ ุงูุฑุฆูุณูุฉ</th>
              <th>ุงููุฆุฉ ุงููุฑุนูุฉ</th>
              <th>ูุณุจุจุงุช ุงูุฎุทุฑ</th>
              <th>ุงูุดุฏุฉ</th>
              <th>ุงูุงุญุชูุงููุฉ</th>
              <th>ุงูุชูููู</th>
              <th>ุงูุฅุฏุงุฑุฉ ุงููุณุคููุฉ</th>
              <th>ุงูุดุฎุต ุงููุณุคูู</th>
              <th>ููุงุฉ ุงูุชูุงุตู</th>
              <th>ููุงุญุธุงุช</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <p id="privateEmpty" class="empty">ูุง ุชูุฌุฏ ุณุฌูุงุช ูู ุงูุณุฌู ุงูุฎุงุต ุญุชู ุงูุขู.</p>
    </section>
  </main>
</div>
<script src="{% static 'assets/js/risk.js' %}"></script>
<script src="{% static 'assets/js/system.js' %}"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {

    const user = ohsmsGetCurrentUser();

    // ุงุฐุง ูู ูุณุฌู ุฏุฎูู
   if(!user){
    alert("ุงูุฑุฌุงุก ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู");
    location.href = "/login/";
    return;
}

if(!ohsmsHasPermission("view_risks")){
    alert("ุบูุฑ ูุตุฑุญ ูู ุจุงูุฏุฎูู ุฅูู ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ");
    location.href = "/";
    return;
}

});
</script>

<div id="riskModal" class="modal hidden">
  <div class="modal-box">
    <h3 id="modalTitle"></h3>
    <div id="modalContent" class="info-block"></div>
    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeModal()">ุฅุบูุงู</button>
    </div>
  </div>
</div>



</body>
</html>
